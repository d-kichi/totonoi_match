<h2>あなたのサウナタイプは…</h2>

<p><strong><%= @result.sauna_type.name %></strong></p>
<p><%= @result.headline %></p>
<p><%= @result.body %></p>
<p><%= @result.recommendation_note %></p>
<%= link_to 'あなたのタイプ詳細を見る', result_path(@result.id), class: 'btn btn-primary mt-3' %>

<hr>

<div class="share-section mt-5">
  <h3>診断結果をシェアしよう！</h3>

  <!-- URLコピー機能 -->
  <button id="copyButton" class="btn btn-outline-primary me-3">結果ページのURLをコピー</button>
  <p id="copyMessage" style="display:none; color:green; margin-top:10px;">コピーしました！</p>

  <!-- SNS共有ボタン -->
  <div class="sns-share mt-4">
    <a href="https://twitter.com/intent/tweet?text=<%= CGI.escape("あなたのサウナタイプは『#{@result.sauna_type.name}』！\n#{@result.headline}\n#ととのいmatch") %>&url=<%= CGI.escape(request.original_url) %>"
   target="_blank"
   class="btn btn-outline-info me-2">
   X（Twitter）でシェア
</a>

    <a href="https://social-plugins.line.me/lineit/share?url=<%= request.original_url %>"
       target="_blank"
       class="btn btn-success">
       LINEで送る
    </a>
  </div>
</div>

<!-- URLコピー用スクリプト -->
<script>
document.addEventListener("turbo:load", initCopyButton);
document.addEventListener("DOMContentLoaded", initCopyButton);

function initCopyButton() {
  const copyButton = document.getElementById("copyButton");
  const copyMessage = document.getElementById("copyMessage");
  if (!copyButton) return;

  copyButton.addEventListener("click", async () => {
    try {
      await navigator.clipboard.writeText(window.location.href);
      copyMessage.style.display = "block";
      setTimeout(() => copyMessage.style.display = "none", 2000);
    } catch (err) {
      alert("コピーに失敗しました");
    }
  });
}
</script>
